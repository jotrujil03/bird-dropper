{{> header}}

<div class="settings container py-5">
  <h1 class="settings__title text-center mb-5">Settings</h1>

  <div class="row gy-5 gx-4 justify-content-center">
    <!-- Website Settings -->
    <div class="col-12 col-lg-8">
      <div class="card shadow-lg settings-card">
        <div class="card-header bg-gradient text-white d-flex align-items-center rounded-top">
          <i class="fas fa-cog me-3 fa-lg"></i>
          <h2 class="h5 mb-0">Website Settings</h2>
        </div>
        <div class="card-body">
          <form id="websiteSettingsForm" novalidate>
            <div class="form-floating mb-4">
              <select class="form-select" id="theme" name="theme" aria-label="Select theme">
                <option value="light">Light</option>
                <option value="dark">Dark</option>
              </select>
              <label for="theme">Theme</label>
            </div>
            <button type="submit" class="btn btn-primary w-100">Save</button>
            <div id="websiteSettingsMessage" class="mt-3" role="alert" aria-live="polite"></div>
          </form>
        </div>
      </div>
    </div>

    {{#if user}}
    <!-- Profile & Account Settings -->
    <div class="col-12 col-lg-4">
      <!-- Profile Info Card -->
      <div class="card shadow-lg mb-4 settings-card">
        <div class="card-header bg-gradient text-white d-flex align-items-center rounded-top">
          <i class="fas fa-user me-3 fa-lg"></i>
          <h2 class="h5 mb-0">Profile</h2>
        </div>
        <div class="card-body">
          <div class="mb-3">
            <label class="form-label fw-bold">Email</label>
            <p class="form-control-plaintext">{{user.email}}</p>
          </div>
        </div>
      </div>

      <!-- Accordion -->
      <div class="accordion" id="settingsAccordion">
        <!-- Username -->
        <div class="accordion-item">
          <h2 class="accordion-header" id="headingUsername">
            <button class="accordion-button collapsed" type="button"
                    data-bs-toggle="collapse" data-bs-target="#collapseUsername"
                    aria-expanded="false" aria-controls="collapseUsername">
              <i class="fas fa-user-edit me-2 fa-lg"></i> Change Username
            </button>
          </h2>
          <div id="collapseUsername" class="accordion-collapse collapse"
               aria-labelledby="headingUsername" data-bs-parent="#settingsAccordion">
            <div class="accordion-body">
              <form id="usernameForm" novalidate>
                <div class="form-floating mb-4">
                  <input type="text" class="form-control" id="username" name="username"
                         value="{{user.username}}" placeholder="Username">
                  <label for="username">Username</label>
                </div>
                <button type="submit" class="btn btn-primary w-100">Update</button>
                <div id="usernameMessage" class="mt-3" role="alert" aria-live="polite"></div>
              </form>
            </div>
          </div>
        </div>

        <!-- Password -->
        <div class="accordion-item">
          <h2 class="accordion-header" id="headingPassword">
            <button class="accordion-button collapsed" type="button"
                    data-bs-toggle="collapse" data-bs-target="#collapsePassword"
                    aria-expanded="false" aria-controls="collapsePassword">
              <i class="fas fa-lock me-2 fa-lg"></i> Change Password
            </button>
          </h2>
          <div id="collapsePassword" class="accordion-collapse collapse"
               aria-labelledby="headingPassword" data-bs-parent="#settingsAccordion">
            <div class="accordion-body">
              <form id="passwordForm" novalidate>
                <div class="form-floating mb-3">
                  <input type="password" class="form-control" id="currentPassword"
                         name="currentPassword" placeholder="Current Password">
                  <label for="currentPassword">Current Password</label>
                </div>
                <div class="form-floating mb-3">
                  <input type="password" class="form-control" id="newPassword"
                         name="newPassword" placeholder="New Password">
                  <label for="newPassword">New Password</label>
                </div>
                <div class="form-floating mb-4">
                  <input type="password" class="form-control" id="confirmPassword"
                         name="confirmPassword" placeholder="Confirm New Password">
                  <label for="confirmPassword">Confirm New Password</label>
                </div>
                <button type="submit" class="btn btn-primary w-100">Update</button>
                <div id="passwordMessage" class="mt-3" role="alert" aria-live="polite"></div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
    {{else}}
    <div class="col-12">
      <div class="alert alert-info text-center">
        You need to be logged in to view and change your settings.
        <a href="/login" class="fw-bold">Log in here</a>.
      </div>
    </div>
    {{/if}}
  </div>
</div>

<style>
  :root {
    --primary: #007bff;
    --primary-dark: #0056b3;
    --text-dark: #343a40;
  }

  .settings__title {
    font-size: 2.75rem;
    color: var(--text-dark);
    font-weight: 600;
  }

  .bg-gradient {
    background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  }

  .settings-card {
    border: none;
    border-radius: 1rem;
    overflow: hidden;
  }

  .settings-card .card-body {
    padding: 2rem;
  }

  .card-header h2 {
    font-size: 1.5rem;
  }

  .form-control,
  .form-select {
    font-size: 1.125rem;
    padding: 1rem 0.75rem;
  }

  .btn-primary {
    font-size: 1.125rem;
    padding: 0.75rem 1.25rem;
    background-color: var(--primary);
    border-color: var(--primary);
    transition: background-color 0.2s, border-color 0.2s;
  }

  .btn-primary:hover {
    background-color: var(--primary-dark);
    border-color: var(--primary-dark);
  }

  .accordion-button {
    font-size: 1.15rem;
    padding: 1rem 1.25rem;
  }

  .form-control:focus,
  .form-select:focus {
    box-shadow: 0 0 0 0.2rem rgba(0,123,255,0.25);
    border-color: var(--primary);
  }

  .settings {
    max-width: 1200px;
    margin: 0 auto;
  }
</style>

{{> footer}}
